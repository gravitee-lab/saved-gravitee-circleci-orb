description: >
  This example demonstrates how to use the "`release`" `Orb` job, in a Gravitee.io Software Developement repo's Pipeline

usage:
  version: 2.1
  parameters:
    gio_action:
      type: enum
      enum: [release, pr_build]
      default: pr_build
    dry_run:
      type: boolean
      default: true
      description: "Run in dry run mode?"
    secrethub_org:
      type: string
      default: "your-secrethuborg"
      description: "SecretHub Org to use to fetch CI CD secrets ?"
    secrethub_repo:
      type: string
      default: "your-secrethubrepo"
      description: "SecretHub Repo to use to fetch CI CD secrets ?"

  orbs:
    gravitee: gravitee-io/gravitee@1.0

  workflows:
    version: 2.1
    pull_requests:
      when:
        equal: [ pr_build, << pipeline.parameters.gio_action >> ]
      jobs:
        - gravitee/pr-build:
            context: cicd-orchestrator
    release:
      when:
        equal: [ release, << pipeline.parameters.gio_action >> ]
      jobs:
        - gravitee/release:
            context: cicd-orchestrator
            dry_run: << pipeline.parameters.dry_run >>
            # maven_version: 3.6.3
            secrethub_org: << pipeline.parameters.secrethub_org >>
            secrethub_repo: << pipeline.parameters.secrethub_repo >>
